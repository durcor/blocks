#!/bin/sh

case $BLOCK_BUTTON in
    1) notify-send "Info for $(neofetch cpu)" "$(sensors | grep -A8 k10)" ;;
	3) notify-send -i /dev/null "CPU hogs" "$(ps axch -o cmd:15,%cpu --sort=-%cpu | head)" ;;
esac

threads="$(nproc)"

usage=$(echo "$(ps aux | awk 'BEGIN {sum=0} {sum+=$3}; END {print sum}')/$threads" | bc)

icon="ïƒ¤"

clock=$(echo "$(lscpu | awk '/MHz/ {print $3}')/1000" | bc -ql | cut -c-3)

command=$(sensors | awk '/^Tdie/ {print $2}')

echo "$icon  $((usage))% ${clock}GHz ${command}"
